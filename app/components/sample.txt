"use client";
import React, { useEffect, useRef, useState } from "react";

export default function IntroductionVideo() {
  const videoRef = useRef<HTMLVideoElement>(null);
  const [skipTimer, setSkipTimer] = useState(5); // seconds
  const [canSkip, setCanSkip] = useState(false);

  useEffect(() => {
    // Start countdown timer
    const interval = setInterval(() => {
      setSkipTimer((prev) => {
        if (prev <= 1) {
          clearInterval(interval);
          setCanSkip(true);
          return 0;
        }
        return prev - 1;
      });
    }, 1000);

    // Auto-play when video is ready
    const video = videoRef.current;
    if (video) {
      video.play().catch((err) => console.log("Autoplay blocked:", err));
    }

    return () => clearInterval(interval);
  }, []);

  return (
    <div className="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50">
      <div className="bg-white rounded-lg p-4 w-[90%] max-w-3xl relative">
        <p className="font-semibold text-lg mb-2">
          Thank you for visiting us! Learn more about us by watching this video.
        </p>
        <video
          ref={videoRef}
          src="/videos/video.mp4"
          className="w-full h-80 object-cover rounded-lg"
          autoPlay
          muted
          playsInline
        />
        <div className="absolute top-3 right-5 text-gray-600 text-sm">
          {canSkip
            ? <button className="text-red-500 font-semibold">Skip âœ•</button>
            : `You can skip after ${skipTimer} seconds`}
        </div>
      </div>
    </div>
  );
}
